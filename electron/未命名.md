#  electron

使用HTML、CSS、JS来构建跨平台桌面应用

![75057062506](C:\Users\zxh\Desktop\前端\electron\未命名.assets\1750570625060.png)

可以用vue！





####  流程模型

![75057130967](C:\Users\zxh\Desktop\前端\electron\未命名.assets\1750571309675.png)





####  初始化-搭建工程

![75057183355](C:\Users\zxh\Desktop\前端\electron\未命名.assets\1750571833554.png)

author和license和description一定要写

然后进行安装

`npm install --save-dev electron`

![75057224263](C:\Users\zxh\Desktop\前端\electron\未命名.assets\1750572242630.png)

main.js就是你的主进程的控制文件

```javascript
const{app,BrowserWindow}=require('electron')

app.on('ready',()=>{
    const win =new BrowserWindow({
        width:800,
        height:600,
        autoHideMenuBar:true,
        x:0,
        y:0,
        //窗口位置
        alwaysOnTop:true
    })
    win.loadURL("erl")
    win.loadFile("./Pages/index.html")
})
```

![75708399771](C:\Users\zxh\Desktop\前端\electron\未命名.assets\1757083997718.png)

多个进程，

![75708402891](C:\Users\zxh\Desktop\前端\electron\未命名.assets\1757084028919.png)





####  加载本地页面

![75057320150](C:\Users\zxh\Desktop\前端\electron\未命名.assets\1750573201508.png)

这个报错不用理会

![75057322848](C:\Users\zxh\Desktop\前端\electron\未命名.assets\1750573228481.png)

在控制台这里,需要解决这个警告

**内容安全策略**

![75057326490](C:\Users\zxh\Desktop\前端\electron\未命名.assets\1750573264906.png)

![75057331554](C:\Users\zxh\Desktop\前端\electron\未命名.assets\1750573315540.png)

要用meta标签配置

配置:

<meta http-equiv="Content-Secutity-Policy" content="default-src 'self'; style-scr 'self'; 'unsafe-inline';img-src 'self' data; "

![75057352020](C:\Users\zxh\Desktop\前端\electron\未命名.assets\1750573520209.png)



####  应用行为

windows|linux

应用所有窗口关闭,那么应用自动退出

mac

不会退出

![75057385513](C:\Users\zxh\Desktop\前端\electron\未命名.assets\1750573855135.png)

当所有窗口关闭,如果不是mac,就退出应用

窗口被激活了,并且窗口数量为0,创建窗口

![75057422262](C:\Users\zxh\Desktop\前端\electron\未命名.assets\1750574222622.png)





####  配置自动重启

安装`npm i nodemon -D`

![75057431878](C:\Users\zxh\Desktop\前端\electron\未命名.assets\1750574318783.png)

更改配置

![75057435523](C:\Users\zxh\Desktop\前端\electron\未命名.assets\1750574355232.png)

创建一个新的nodemon文件



####  页面级别

![75057448096](C:\Users\zxh\Desktop\前端\electron\未命名.assets\1750574480966.png)

![75057467983](C:\Users\zxh\Desktop\前端\electron\未命名.assets\1750574679832.png)

主进程和渲染进程是隔离开来的

渲染进行是浏览器环境,也能访问有些node的api

![75057491400](C:\Users\zxh\Desktop\前端\electron\未命名.assets\1750574914006.png)

使用预加载脚本沟通另外两个进行

1. 和渲染进程通信

- 使用绝对路径引入预加载脚本,链接主进程

![75057507332](C:\Users\zxh\Desktop\前端\electron\未命名.assets\1750575073325.png)

- 链接渲染脚本

![75057572607](C:\Users\zxh\Desktop\前端\electron\未命名.assets\1750575726075.png)

window上面挂载了abc,直接打印abc就可以了

2. 和主进程通信

   主进程在loadFile之前订阅相关的预加载消息

   ![75057663326](C:\Users\zxh\Desktop\前端\electron\未命名.assets\1750576633265.png)

   大致代码如上

   ![75057701236](C:\Users\zxh\Desktop\前端\electron\未命名.assets\1750577012363.png)

   ​





####  打包工具

使用electron-buileder打包应用

1. 安装electron-buileder

   `npm i electron-builder -D`

2. 完善package.json文件

   ![75057730675](C:\Users\zxh\Desktop\前端\electron\未命名.assets\1750577306754.png)

   package.json不允许注释

3. ![75057739268](C:\Users\zxh\Desktop\前端\electron\未命名.assets\1750577392684.png)

4. 安装完成后的文件

   比较大,安装完会更大,electron会有比较大的

   哪个文件夹是一个无关的东西

5. 实际上这个electron可以用vue来编写

   ​

   ​


















#  详细入门

 ![75289111942](C:\Users\zxh\Desktop\前端\electron\未命名.assets\1752891119421.png)

![75289133357](C:\Users\zxh\Desktop\前端\electron\未命名.assets\1752891333574.png)

原生app性能好一点，直接使用本地的api，但成本比较大

webapp在于跨平台，热发布，更新方便，性能也差

小程序在于便捷，但性能差，结合app和web

![75289167532](C:\Users\zxh\Desktop\前端\electron\未命名.assets\1752891675323.png)

鸿蒙是通过js直接编译，不依赖浏览器环境





####  electron探秘

 使用electron处理，让web可以访问硬件设备

![75289356022](C:\Users\zxh\Desktop\前端\electron\未命名.assets\1752893560226.png)

![75289374350](C:\Users\zxh\Desktop\前端\electron\未命名.assets\1752893743500.png)





#### 开发自己的程序

![75289395064](C:\Users\zxh\Desktop\前端\electron\未命名.assets\1752893950645.png)

注意node版本，不然很麻烦

 `npm i electron -D`

main.js文件

```javascript
const {app} = require('electron')

const createWindow = ()=>{
    const win = new BrowserWindow({
        width:1000,
        height:800
    })
    win.loadURL("xxxx")
}

app.whenReady().then()
//返回的是promise文件

```

安装`npm i nodemon -g`

打开发现,相当于嵌套了一个壳

也可以使用yarn进行开发，yarn make打包

![75717743518](C:\Users\zxh\Desktop\前端\electron\未命名.assets\1757177435189.png)

可执行文件目录



 ####  主进程和渲染进程

![75717798323](C:\Users\zxh\Desktop\前端\electron\未命名.assets\1757177983230.png)

electron在主进程和渲染进程中提供了大量api去帮助开发桌面应用程序，在主进程和渲染进程中，你可以通过require的方式将其包含在模块中，以此获得electron的api

> const electron = require('electron')

要现在index.js文件里面进行配置,

```javascript
const createWindow = () =>{
    const mainWindow = new BrowserWindow({
        width:800,
        height:600,
        webPreference:{
            nodeIntegration:true
        }
    });
    
    mainWindow.loadFile(path.join(__dirname,"index.html"))
}
```



####  webview

这是一个可以展示其他网页的选项

要在

```javascript
//在idnex.js里面设置
const createWindow = () =>{
    const mainWindow = new BrowserWindow({
        width:800,
        height:600,
        webPreference:{
            webviewTag:true
        }
    });
    
    mainWindow.loadFile(path.join(__dirname,"index.html"))
}
```

可以在index.js写一些加载样式

可以在外部对里面的网页进行修改

和进行一些操作



####  主进程和渲染进程的通信

主进程

```javascript
const {app,BrowserWindow,ipcMain} = require('electrom');
const path = require('path')

ipcMain.on('lc-message',(event,arg)=>{
    event.reply('lc-reply',"这是主进程的答复")
    console.log(arg )
})

const createWindow = () => {
  // Create the browser window.
  const mainWindow = new BrowserWindow({
    width: 800,
    height: 600,
    webPreferences: {
      preload: path.join(__dirname, 'preload.js'),
            contextIsolation: true, // 默认就是true，确保启用上下文隔离
      nodeIntegration: false // 确保Node.js集成关闭
    }
  })
  
  mainWindow.webContents.send('ic-active',"创建窗口之后,主进程主动发送数据 ")
}
```

渲染进程

``` javascript
let {ipcRenderer} = require('electron')

ipcRenderer.on('lc-active',(event,arg)=>{
    console.log(event)
    console.log(arg)
})

ipcRenderer.send('lc-message',"数据")
```



>  如果控制台输出的不是utf-8的就在package.json里面写
>
> "chcp 65001 && electron-force start"
>
> 把编码改成utf-8





####  dialog窗口的配置

在index.js文件引入：

```javascript
const {app, BrowserWindow,dialog} = require('electron');
//引入相关的diakog
dialog.showOpenDialog({
    properties:['openFile','multiSeletions']
    //打开文件选择窗口
}).then((res)=>{
    //你的结果对象
    
})
```

> openFile允许选择文件
>
> openDirectory允许选择文件夹
>
> multiSelection允许多选
>
> showHiddenFiles显示隐藏文件
>
> createDiectory允许创建文件夹

设置相关的权限



关闭确认窗口

```javascript
mainWindow.on('close',(e)=>{
    e.preventDefault()
    dialog.showMessageBox(mainWindow,{
        type:'warning',
        title:"关闭",
        message:"是否要关闭"
        buttons:['取消','确认关闭']
    }).then((index)=>{
        //点击第一个会有一个索引值返回给你
        if(index.response===1){
            app.exit()
        }
    })
})
```







####  自带的原生网络请求库

请求数据和监听数据的结合

![75778095880](C:\Users\zxh\Desktop\前端\electron\未命名.assets\1757780958807.png)

记得加request.edn()



####  electron-vue

使用vue来写electron

![75793411636](C:\Users\zxh\Desktop\前端\electron\未命名.assets\1757934116364.png)

如果有报错，就去搜索，然后修改一些配置文件



项目的基本架构

![75800003631](C:\Users\zxh\Desktop\前端\electron\未命名.assets\1758000036312.png)



####  使用antd的ui框架

![75800028099](C:\Users\zxh\Desktop\前端\electron\未命名.assets\1758000280999.png)

![75800029100](C:\Users\zxh\Desktop\前端\electron\未命名.assets\1758000291006.png)



####  请求跨域

![75800137286](C:\Users\zxh\Desktop\前端\electron\未命名.assets\1758001372860.png)

加上一个webPreferences：{

webSecurity：false

}

 















  
